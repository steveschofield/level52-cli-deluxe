# Autonomous AI-Driven Penetration Testing
# Let the AI decide each step dynamically
# Supports optional whitebox analysis when --source is provided

name: autonomous
description: Fully autonomous AI-driven penetration test with optional source code analysis

mode: autonomous  # Special mode - AI makes all decisions

# Whitebox phase - runs first if --source parameter is provided
whitebox:
  enabled_if_source: true
  tools:
    - semgrep
    - trivy
    - gitleaks
    - trufflehog
  extract_attack_surface: true
  ai_analysis: true
  feed_to_autonomous: true  # SAST findings inform AI decision-making

# Run ZAP early to build a rich seed URL set before the AI takes over.
# When whitebox is available, seed URLs from source analysis accelerate
# discovery. Without source, ZAP spiders from the target URL alone.
pre_steps:
  - name: http_discovery
    type: tool
    tool: httpx
    objective: "Discover web services and fingerprint technologies"
    parameters:
      tech_detect: true

  - name: zap_early_scan
    type: tool
    tool: zap
    objective: "Spider the target early to build a rich URL set for autonomous decisions"
    condition: zap_available
    parameters:
      use_whitebox_seeds: true
      spider: true
      ajax_spider: true
    dependencies:
      - http_discovery

  - name: gobuster_discovery
    type: tool
    tool: gobuster
    objective: "Directory brute-force using wordlist enriched with ZAP-discovered paths"
    parameters: {}
    dependencies:
      - zap_early_scan

initial_phase: reconnaissance

# AI will use these guidelines
ai_guidelines:
  - "Use ZAP seed URLs from the early scan to inform tool targeting"
  - "Start with passive reconnaissance"
  - "Progress from low-impact to high-impact actions"
  - "Always analyze results before next step"
  - "Stop when no new findings or max_steps reached"
  - "Prioritize critical and high severity findings"
  - "Respect scope and safety constraints"

max_steps: 25
max_duration_minutes: 120

# Available agents
agents:
  planner: enabled
  tool_selector: enabled
  analyst: enabled
  reporter: enabled

# Final report
report:
  format: markdown
  include_ai_trace: true
  include_reasoning: true

settings:
  safe_mode: true
  require_confirmation: true  # User confirms each major action
  save_intermediate: true
